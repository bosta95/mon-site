<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | IPTV Pro</title>
    <link href="styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(to bottom, #1e1e2f, #0a0a1a);
            color: #fff;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar */
        .admin-sidebar {
            width: 250px;
            background: rgba(25, 25, 40, 0.95);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            z-index: 1000;
        }

        .admin-logo {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-logo h2 {
            margin: 0;
            font-size: 1.5rem;
            background: linear-gradient(90deg, #6c5498, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .admin-menu {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        .admin-menu li {
            margin: 5px 0;
        }

        .admin-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #b4b4cc;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .admin-menu a:hover,
        .admin-menu a.active {
            background: rgba(108, 84, 152, 0.2);
            color: #fff;
            border-left: 3px solid #6c5498;
        }

        .admin-menu i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .admin-menu-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .menu-section-title {
            padding: 0 20px;
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 10px;
        }

        /* Main content */
        .admin-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            overflow-y: auto;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .admin-actions {
            display: flex;
            align-items: center;
        }

        .admin-btn {
            background: linear-gradient(90deg, #6c5498, #ff6b6b);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .admin-btn i {
            margin-right: 5px;
        }

        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 84, 152, 0.4);
        }

        /* Dashboard stats */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(25, 25, 40, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stat-title {
            font-size: 0.9rem;
            color: #b4b4cc;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #6c5498, #ff6b6b);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
        }

        .stat-description {
            font-size: 0.8rem;
            color: #8e8ea9;
            margin-top: 5px;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(25, 25, 40, 0.7);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table th, 
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table th {
            background: rgba(108, 84, 152, 0.2);
            font-weight: 600;
            color: #fff;
            text-transform: uppercase;
            font-size: 0.8rem;
        }

        .data-table tr:hover {
            background: rgba(108, 84, 152, 0.1);
        }

        .data-table td {
            color: #b4b4cc;
        }

        /* Sections */
        .admin-section {
            display: none;
            margin-bottom: 40px;
        }

        .admin-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        /* Status badges */
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-active {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }

        .status-pending {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }

        .status-inactive {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        /* Action buttons */
        .action-btn {
            background: none;
            border: none;
            color: #6c5498;
            cursor: pointer;
            font-size: 1rem;
            transition: color 0.3s;
            padding: 5px;
        }

        .action-btn:hover {
            color: #ff6b6b;
        }

        /* Forms */
        .admin-form {
            background: rgba(25, 25, 40, 0.7);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: #fff;
            font-size: 16px;
        }

        .form-control:focus {
            outline: none;
            border-color: #6c5498;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .admin-sidebar {
                width: 70px;
                overflow: visible;
            }

            .admin-sidebar .admin-logo h2,
            .admin-sidebar .menu-section-title,
            .admin-sidebar .admin-menu span {
                display: none;
            }

            .admin-menu a {
                justify-content: center;
                padding: 15px;
            }

            .admin-menu i {
                margin-right: 0;
                font-size: 1.2rem;
            }

            .admin-content {
                margin-left: 70px;
            }

            .form-row {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body class="admin-page">
    <!-- Sidebar -->
    <div class="admin-sidebar">
        <div class="admin-logo">
            <h2>IPTV Admin</h2>
        </div>
        
        <ul class="admin-menu">
            <li><a href="#dashboard" class="active" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt"></i> <span>Tableau de bord</span>
            </a></li>
            <li><a href="#users" onclick="showSection('users')">
                <i class="fas fa-users"></i> <span>Utilisateurs</span>
            </a></li>
            <li><a href="#orders" onclick="showSection('orders')">
                <i class="fas fa-shopping-cart"></i> <span>Commandes</span>
            </a></li>
            <li><a href="#emails" onclick="showSection('emails')">
                <i class="fas fa-envelope"></i> <span>Emails</span>
            </a></li>
        </ul>
        
        <div class="admin-menu-section">
            <div class="menu-section-title">Administration</div>
            <ul class="admin-menu">
                <li><a href="#settings" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i> <span>Paramètres</span>
                </a></li>
                <li><a href="#logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> <span>Déconnexion</span>
                </a></li>
            </ul>
        </div>
    </div>

    <!-- Main content -->
    <div class="admin-content">
        <!-- Header -->
        <div class="admin-header">
            <div class="page-title" id="current-section-title">Tableau de bord</div>
            <div class="admin-actions">
                <button class="admin-btn" onclick="refreshData()">
                    <i class="fas fa-sync-alt"></i> Actualiser
                </button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard" class="admin-section active">
            <!-- Stats Row -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Utilisateurs</div>
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                    </div>
                    <h3 class="stat-value" id="total-users">0</h3>
                    <p class="stat-description">Utilisateurs inscrits</p>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Commandes</div>
                        <div class="stat-icon"><i class="fas fa-shopping-cart"></i></div>
                    </div>
                    <h3 class="stat-value" id="total-orders">0</h3>
                    <p class="stat-description">Commandes récentes</p>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Revenus</div>
                        <div class="stat-icon"><i class="fas fa-euro-sign"></i></div>
                    </div>
                    <h3 class="stat-value" id="total-revenue">0€</h3>
                    <p class="stat-description">Ce mois-ci</p>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Emails</div>
                        <div class="stat-icon"><i class="fas fa-envelope"></i></div>
                    </div>
                    <h3 class="stat-value" id="total-emails">0</h3>
                    <p class="stat-description">Emails envoyés</p>
                </div>
            </div>
            
            <!-- Recent Orders Table -->
            <div class="section-header">
                <div class="section-title">Commandes récentes</div>
                <button class="admin-btn" onclick="showSection('orders')">
                    Voir tout <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            
            <table class="data-table" id="recent-orders-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Client</th>
                        <th>Produit</th>
                        <th>Date</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="recent-orders-body">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Users Section -->
        <div id="users" class="admin-section">
            <div class="section-header">
                <div class="section-title">Gestion des utilisateurs</div>
                <button class="admin-btn" onclick="showAddUserForm()">
                    <i class="fas fa-plus"></i> Ajouter un utilisateur
                </button>
            </div>
            
            <!-- User search and filter -->
            <div class="admin-form" style="margin-bottom: 20px;">
                <div class="form-row">
                    <div class="form-group">
                        <input type="text" class="form-control" id="user-search" placeholder="Rechercher un utilisateur..." oninput="filterUsers()">
                    </div>
                    <div class="form-group" style="flex: 0 0 200px;">
                        <select class="form-control" id="status-filter" onchange="filterUsers()">
                            <option value="all">Tous les statuts</option>
                            <option value="active">Actif</option>
                            <option value="inactive">Inactif</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Users table -->
            <table class="data-table" id="users-table">
                <thead>
                    <tr>
                        <th>Nom d'utilisateur</th>
                        <th>Email</th>
                        <th>Produit</th>
                        <th>Date d'inscription</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="users-body">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Add/Edit User Form (Hidden by default) -->
            <div id="user-form-container" style="display: none; margin-top: 30px;">
                <div class="admin-form">
                    <h3 id="user-form-title">Ajouter un utilisateur</h3>
                    <form id="user-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="user-username">Nom d'utilisateur</label>
                                <input type="text" class="form-control" id="user-username" required>
                            </div>
                            <div class="form-group">
                                <label for="user-email">Email</label>
                                <input type="email" class="form-control" id="user-email" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="user-password">Mot de passe</label>
                                <input type="password" class="form-control" id="user-password" required>
                            </div>
                            <div class="form-group">
                                <label for="user-product">Produit</label>
                                <select class="form-control" id="user-product" required>
                                    <option value="">Sélectionner un produit</option>
                                    <option value="IPTV Standard">IPTV Standard</option>
                                    <option value="IPTV Premium">IPTV Premium</option>
                                    <option value="IPTV Premium+">IPTV Premium+</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="user-status">Statut</label>
                                <select class="form-control" id="user-status" required>
                                    <option value="active">Actif</option>
                                    <option value="inactive">Inactif</option>
                                </select>
                            </div>
                        </div>
                        <div style="text-align: right; margin-top: 20px;">
                            <button type="button" class="admin-btn" style="background: #444;" onclick="hideUserForm()">Annuler</button>
                            <button type="submit" class="admin-btn">Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Orders Section -->
        <div id="orders" class="admin-section">
            <div class="section-header">
                <div class="section-title">Gestion des commandes</div>
                <button class="admin-btn" onclick="showAddOrderForm()">
                    <i class="fas fa-plus"></i> Ajouter une commande
                </button>
            </div>
            
            <!-- Order search and filter -->
            <div class="admin-form" style="margin-bottom: 20px;">
                <div class="form-row">
                    <div class="form-group">
                        <input type="text" class="form-control" id="order-search" placeholder="Rechercher une commande..." oninput="filterOrders()">
                    </div>
                    <div class="form-group" style="flex: 0 0 200px;">
                        <select class="form-control" id="order-status-filter" onchange="filterOrders()">
                            <option value="all">Tous les statuts</option>
                            <option value="active">Actif</option>
                            <option value="pending">En attente</option>
                            <option value="inactive">Inactif</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Orders table -->
            <table class="data-table" id="orders-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Client</th>
                        <th>Email</th>
                        <th>Produit</th>
                        <th>Date</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="orders-body">
                    <!-- Will be filled by JavaScript -->
                </tbody>
            </table>
            
            <!-- Add/Edit Order Form (Hidden by default) -->
            <div id="order-form-container" style="display: none; margin-top: 30px;">
                <div class="admin-form">
                    <h3 id="order-form-title">Ajouter une commande</h3>
                    <form id="order-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="order-client">Nom du client</label>
                                <input type="text" class="form-control" id="order-client" required>
                            </div>
                            <div class="form-group">
                                <label for="order-email">Email</label>
                                <input type="email" class="form-control" id="order-email" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="order-product">Produit</label>
                                <select class="form-control" id="order-product" required>
                                    <option value="">Sélectionner un produit</option>
                                    <option value="IPTV Standard">IPTV Standard</option>
                                    <option value="IPTV Premium">IPTV Premium</option>
                                    <option value="IPTV Premium+">IPTV Premium+</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="order-status">Statut</label>
                                <select class="form-control" id="order-status" required>
                                    <option value="active">Actif</option>
                                    <option value="pending">En attente</option>
                                    <option value="inactive">Inactif</option>
                                </select>
                            </div>
                        </div>
                        <div style="text-align: right; margin-top: 20px;">
                            <button type="button" class="admin-btn" style="background: #444;" onclick="hideOrderForm()">Annuler</button>
                            <button type="submit" class="admin-btn">Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Emails Section -->
        <div id="emails" class="admin-section">
            <div class="section-header">
                <div class="section-title">Gestion des emails</div>
                <button class="admin-btn" onclick="showSendEmailForm()">
                    <i class="fas fa-paper-plane"></i> Envoyer un email
                </button>
            </div>
            
            <!-- Email templates -->
            <div class="section-header" style="margin-top: 30px;">
                <div class="section-title">Modèles d'emails</div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Confirmation de commande</div>
                    </div>
                    <p>Email envoyé automatiquement après une commande</p>
                    <button class="admin-btn" onclick="editEmailTemplate('order-confirmation')">
                        <i class="fas fa-edit"></i> Modifier
                    </button>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Bienvenue</div>
                    </div>
                    <p>Email envoyé après inscription</p>
                    <button class="admin-btn" onclick="editEmailTemplate('welcome')">
                        <i class="fas fa-edit"></i> Modifier
                    </button>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">Rappel d'expiration</div>
                    </div>
                    <p>Email envoyé avant expiration de l'abonnement</p>
                    <button class="admin-btn" onclick="editEmailTemplate('expiration')">
                        <i class="fas fa-edit"></i> Modifier
                    </button>
                </div>
            </div>
            
            <!-- Send Email Form (Hidden by default) -->
            <div id="email-form-container" style="display: none; margin-top: 30px;">
                <div class="admin-form">
                    <h3>Envoyer un email</h3>
                    <form id="email-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email-to">Destinataire</label>
                                <select class="form-control" id="email-to" required>
                                    <option value="">Sélectionner le destinataire</option>
                                    <option value="all">Tous les utilisateurs</option>
                                    <option value="active">Utilisateurs actifs</option>
                                    <option value="inactive">Utilisateurs inactifs</option>
                                    <option value="custom">Email personnalisé</option>
                                </select>
                            </div>
                            <div class="form-group" id="custom-email-container" style="display: none;">
                                <label for="custom-email">Email personnalisé</label>
                                <input type="email" class="form-control" id="custom-email" placeholder="exemple@mail.com">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email-subject">Sujet</label>
                                <input type="text" class="form-control" id="email-subject" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email-body">Contenu</label>
                                <textarea class="form-control" id="email-body" rows="8" required></textarea>
                            </div>
                        </div>
                        <div style="text-align: right; margin-top: 20px;">
                            <button type="button" class="admin-btn" style="background: #444;" onclick="hideEmailForm()">Annuler</button>
                            <button type="submit" class="admin-btn">Envoyer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="admin-section">
            <div class="section-header">
                <div class="section-title">Paramètres du système</div>
            </div>
            
            <div class="admin-form">
                <h3>Configuration SMTP</h3>
                <form id="smtp-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="smtp-host">Serveur SMTP</label>
                            <input type="text" class="form-control" id="smtp-host" value="smtp.office365.com" required>
                        </div>
                        <div class="form-group">
                            <label for="smtp-port">Port</label>
                            <input type="number" class="form-control" id="smtp-port" value="587" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="smtp-user">Utilisateur</label>
                            <input type="text" class="form-control" id="smtp-user" value="smarter-iptv@hotmail.com" required>
                        </div>
                        <div class="form-group">
                            <label for="smtp-pass">Mot de passe</label>
                            <input type="password" class="form-control" id="smtp-pass" value="••••••••••" required>
                        </div>
                    </div>
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="submit" class="admin-btn">Enregistrer</button>
                    </div>
                </form>
            </div>
            
            <div class="admin-form" style="margin-top: 30px;">
                <h3>Paramètres du site</h3>
                <form id="site-settings-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="site-name">Nom du site</label>
                            <input type="text" class="form-control" id="site-name" value="IPTV Pro" required>
                        </div>
                        <div class="form-group">
                            <label for="site-email">Email de contact</label>
                            <input type="email" class="form-control" id="site-email" value="smarter-iptv@hotmail.com" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="maintenance-mode">Mode maintenance</label>
                            <select class="form-control" id="maintenance-mode">
                                <option value="off">Désactivé</option>
                                <option value="on">Activé</option>
                            </select>
                        </div>
                    </div>
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="submit" class="admin-btn">Enregistrer</button>
                    </div>
                </form>
            </div>
            
            <div class="admin-form" style="margin-top: 30px;">
                <h3>Modifier le mot de passe admin</h3>
                <form id="admin-password-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="current-password">Mot de passe actuel</label>
                            <input type="password" class="form-control" id="current-password" required>
                        </div>
                        <div class="form-group">
                            <label for="new-password">Nouveau mot de passe</label>
                            <input type="password" class="form-control" id="new-password" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="confirm-password">Confirmer le mot de passe</label>
                            <input type="password" class="form-control" id="confirm-password" required>
                        </div>
                    </div>
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="submit" class="admin-btn">Changer le mot de passe</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Vérifier si l'administrateur est connecté
        document.addEventListener('DOMContentLoaded', function() {
            if (!localStorage.getItem('adminLogged')) {
                window.location.href = 'admin-login.html';
                return;
            }
            
            // Charger les données du tableau de bord
            loadDashboardData();
        });

        // Fonction pour afficher une section
        function showSection(sectionId) {
            // Masquer toutes les sections
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Afficher la section demandée
            document.getElementById(sectionId).classList.add('active');
            
            // Mettre à jour le titre de la page
            const sectionTitles = {
                'dashboard': 'Tableau de bord',
                'users': 'Gestion des utilisateurs',
                'orders': 'Gestion des commandes',
                'emails': 'Gestion des emails',
                'settings': 'Paramètres'
            };
            
            document.getElementById('current-section-title').textContent = sectionTitles[sectionId] || 'Tableau de bord';
            
            // Mettre à jour la navigation
            document.querySelectorAll('.admin-menu a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + sectionId) {
                    link.classList.add('active');
                }
            });
            
            // Charger les données spécifiques à la section
            if (sectionId === 'users') {
                loadUsers();
            } else if (sectionId === 'orders') {
                loadOrders();
            } else if (sectionId === 'emails') {
                loadEmails();
            }
        }

        // Fonction de déconnexion
        function logout() {
            if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
                localStorage.removeItem('adminLogged');
                window.location.href = 'admin-login.html';
            }
        }

        // Fonctions pour charger les données
        function loadDashboardData() {
            // Dans un cas réel, ces données viendraient d'une API
            // Pour ce prototype, nous utilisons des données statiques
            
            // Compter les utilisateurs
            fetch('/api/admin/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-users').textContent = data.users || '0';
                    document.getElementById('total-orders').textContent = data.orders || '0';
                    document.getElementById('total-revenue').textContent = data.revenue || '0€';
                    document.getElementById('total-emails').textContent = data.emails || '0';
                })
                .catch(error => {
                    console.error('Erreur lors du chargement des statistiques:', error);
                    // Simuler des données pour la démonstration
                    document.getElementById('total-users').textContent = '12';
                    document.getElementById('total-orders').textContent = '25';
                    document.getElementById('total-revenue').textContent = '3750€';
                    document.getElementById('total-emails').textContent = '50';
                });
                
            // Charger les commandes récentes
            loadRecentOrders();
        }
        
        function loadRecentOrders() {
            // Simuler les commandes récentes
            const recentOrders = [
                { id: 'CMD-001', client: 'Jean Dupont', email: 'jean@example.com', product: 'IPTV Premium', date: '15/06/2024', status: 'active' },
                { id: 'CMD-002', client: 'Marie Martin', email: 'marie@example.com', product: 'IPTV Standard', date: '14/06/2024', status: 'pending' },
                { id: 'CMD-003', client: 'Pierre Dubois', email: 'pierre@example.com', product: 'IPTV Premium+', date: '12/06/2024', status: 'active' }
            ];
            
            const tbody = document.getElementById('recent-orders-body');
            tbody.innerHTML = '';
            
            recentOrders.forEach(order => {
                const row = document.createElement('tr');
                
                // Statut CSS class
                const statusClass = 
                    order.status === 'active' ? 'status-active' : 
                    order.status === 'pending' ? 'status-pending' : 'status-inactive';
                
                // Texte du statut
                const statusText = 
                    order.status === 'active' ? 'Actif' : 
                    order.status === 'pending' ? 'En attente' : 'Inactif';
                
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.client}</td>
                    <td>${order.product}</td>
                    <td>${order.date}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewOrder('${order.id}')"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" onclick="editOrder('${order.id}')"><i class="fas fa-edit"></i></button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function refreshData() {
            // Recharger les données du tableau de bord
            loadDashboardData();
            
            // Recharger les données de la section active
            const activeSection = document.querySelector('.admin-section.active');
            if (activeSection) {
                const sectionId = activeSection.id;
                if (sectionId === 'users') {
                    loadUsers();
                } else if (sectionId === 'orders') {
                    loadOrders();
                } else if (sectionId === 'emails') {
                    loadEmails();
                }
            }
        }
        
        // Fonctions pour les actions
        function viewOrder(orderId) {
            alert(`Voir la commande ${orderId}`);
            // Ici, vous pourriez ouvrir un modal avec les détails de la commande
        }
        
        function editOrder(orderId) {
            alert(`Éditer la commande ${orderId}`);
            // Ici, vous pourriez ouvrir un formulaire d'édition
        }

        // Fonctions de gestion des utilisateurs
        function loadUsers() {
            // Simuler les utilisateurs
            const users = [
                { username: 'jean5421', email: 'jean@example.com', product: 'IPTV Premium', date: '15/06/2024', status: 'active' },
                { username: 'marie7890', email: 'marie@example.com', product: 'IPTV Standard', date: '14/06/2024', status: 'active' },
                { username: 'pierre3356', email: 'pierre@example.com', product: 'IPTV Premium+', date: '12/06/2024', status: 'inactive' }
            ];
            
            const tbody = document.getElementById('users-body');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                
                // Statut CSS class
                const statusClass = user.status === 'active' ? 'status-active' : 'status-inactive';
                
                // Texte du statut
                const statusText = user.status === 'active' ? 'Actif' : 'Inactif';
                
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.email}</td>
                    <td>${user.product}</td>
                    <td>${user.date}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="editUser('${user.username}')"><i class="fas fa-edit"></i></button>
                        <button class="action-btn" onclick="deleteUser('${user.username}')"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function filterUsers() {
            // Implémentation du filtre utilisateurs
            alert('Filtre utilisateurs à implémenter');
        }
        
        function showAddUserForm() {
            document.getElementById('user-form-title').textContent = 'Ajouter un utilisateur';
            document.getElementById('user-form').reset();
            document.getElementById('user-form-container').style.display = 'block';
        }
        
        function hideUserForm() {
            document.getElementById('user-form-container').style.display = 'none';
        }
        
        function editUser(username) {
            document.getElementById('user-form-title').textContent = 'Modifier l\'utilisateur';
            
            // Dans un cas réel, vous récupéreriez les données de l'utilisateur depuis le serveur
            // Pour cette démo, on remplit avec des données factices
            document.getElementById('user-username').value = username;
            document.getElementById('user-email').value = 'user@example.com';
            document.getElementById('user-password').value = 'password';
            document.getElementById('user-product').value = 'IPTV Premium';
            document.getElementById('user-status').value = 'active';
            
            document.getElementById('user-form-container').style.display = 'block';
        }
        
        function deleteUser(username) {
            if (confirm(`Êtes-vous sûr de vouloir supprimer l'utilisateur ${username} ?`)) {
                alert(`Utilisateur ${username} supprimé`);
                loadUsers(); // Recharger la liste
            }
        }
        
        // Fonctions de gestion des commandes
        function loadOrders() {
            // Simuler les commandes
            const orders = [
                { id: 'CMD-001', client: 'Jean Dupont', email: 'jean@example.com', product: 'IPTV Premium', date: '15/06/2024', status: 'active' },
                { id: 'CMD-002', client: 'Marie Martin', email: 'marie@example.com', product: 'IPTV Standard', date: '14/06/2024', status: 'pending' },
                { id: 'CMD-003', client: 'Pierre Dubois', email: 'pierre@example.com', product: 'IPTV Premium+', date: '12/06/2024', status: 'active' },
                { id: 'CMD-004', client: 'Sophie Lefebvre', email: 'sophie@example.com', product: 'IPTV Premium', date: '10/06/2024', status: 'inactive' },
                { id: 'CMD-005', client: 'Lucas Bernard', email: 'lucas@example.com', product: 'IPTV Standard', date: '08/06/2024', status: 'active' }
            ];
            
            const tbody = document.getElementById('orders-body');
            tbody.innerHTML = '';
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                
                // Statut CSS class
                const statusClass = 
                    order.status === 'active' ? 'status-active' : 
                    order.status === 'pending' ? 'status-pending' : 'status-inactive';
                
                // Texte du statut
                const statusText = 
                    order.status === 'active' ? 'Actif' : 
                    order.status === 'pending' ? 'En attente' : 'Inactif';
                
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.client}</td>
                    <td>${order.email}</td>
                    <td>${order.product}</td>
                    <td>${order.date}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewOrder('${order.id}')"><i class="fas fa-eye"></i></button>
                        <button class="action-btn" onclick="editOrder('${order.id}')"><i class="fas fa-edit"></i></button>
                        <button class="action-btn" onclick="deleteOrder('${order.id}')"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function filterOrders() {
            // Implémentation du filtre commandes
            alert('Filtre commandes à implémenter');
        }
        
        function showAddOrderForm() {
            document.getElementById('order-form-title').textContent = 'Ajouter une commande';
            document.getElementById('order-form').reset();
            document.getElementById('order-form-container').style.display = 'block';
        }
        
        function hideOrderForm() {
            document.getElementById('order-form-container').style.display = 'none';
        }
        
        function deleteOrder(orderId) {
            if (confirm(`Êtes-vous sûr de vouloir supprimer la commande ${orderId} ?`)) {
                alert(`Commande ${orderId} supprimée`);
                loadOrders(); // Recharger la liste
            }
        }
        
        // Fonctions de gestion des emails
        function loadEmails() {
            // Dans un cas réel, vous récupéreriez l'historique des emails
            // Pour cette démo, on ne fait rien de spécial
        }
        
        function showSendEmailForm() {
            document.getElementById('email-form').reset();
            document.getElementById('email-form-container').style.display = 'block';
            
            // Gérer l'affichage du champ email personnalisé
            document.getElementById('email-to').addEventListener('change', function() {
                const customEmailContainer = document.getElementById('custom-email-container');
                if (this.value === 'custom') {
                    customEmailContainer.style.display = 'block';
                } else {
                    customEmailContainer.style.display = 'none';
                }
            });
        }
        
        function hideEmailForm() {
            document.getElementById('email-form-container').style.display = 'none';
        }
        
        function editEmailTemplate(templateId) {
            alert(`Édition du modèle d'email: ${templateId}`);
            // Ouvrir un formulaire d'édition de modèle d'email
        }
        
        // Initialiser les formulaires
        document.addEventListener('DOMContentLoaded', function() {
            // Formulaire d'ajout/édition d'utilisateur
            document.getElementById('user-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Utilisateur enregistré');
                hideUserForm();
                loadUsers();
            });
            
            // Formulaire d'ajout/édition de commande
            document.getElementById('order-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Commande enregistrée');
                hideOrderForm();
                loadOrders();
            });
            
            // Formulaire d'envoi d'email
            document.getElementById('email-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Email envoyé avec succès');
                hideEmailForm();
            });
            
            // Formulaire de configuration SMTP
            document.getElementById('smtp-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Configuration SMTP enregistrée');
            });
            
            // Formulaire de paramètres du site
            document.getElementById('site-settings-form').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Paramètres du site enregistrés');
            });
            
            // Formulaire de changement de mot de passe admin
            document.getElementById('admin-password-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;
                
                if (newPassword !== confirmPassword) {
                    alert('Les mots de passe ne correspondent pas');
                    return;
                }
                
                alert('Mot de passe admin modifié avec succès');
                document.getElementById('admin-password-form').reset();
            });
        });
    </script>
</body>
</html> 